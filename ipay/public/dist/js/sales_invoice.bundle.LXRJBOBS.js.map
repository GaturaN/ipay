{
  "version": 3,
  "sources": ["../../../../../apps/ipay/ipay/public/js/sales_invoice.js"],
  "sourcesContent": ["frappe.ui.form.on(\"Sales Invoice\", {\n   refresh(frm) {\n      const submitted = frm.doc.docstatus === 1;\n      const status = frm.doc.status;\n      const bal = frm.doc.outstanding_amount > 0;\n\n      if (submitted && bal && status !== \"Paid\") {\n         frm.add_custom_button(__(\"iPay Request\"), () => {\n            // console.log(\"Button Working\");\n            //get values from the sales invoice and create an ipay request\n            const customer = frm.doc.customer;\n            const salesInvoice = frm.doc.name;\n\n            // call the frappe.client.insert to create an ipay request\n            frappe.call({\n               method: \"frappe.client.insert\",\n               args: {\n                  doc: {\n                     doctype: \"iPay Request\",\n                     customer: customer,\n                     sales_invoice: salesInvoice,\n                     docstatus: 1,\n                  },\n               },\n               freeze: true,\n               async: true,\n               callback: function (r) {\n                  if (!r.exc) {\n                     //  frappe.msgprint(__(\"iPay Request Created successfully\"));\n                     // show notification\n                     frappe.show_alert(\n                        {\n                           message: __(\"iPay Request Created successfully\"),\n                           indicator: \"green\",\n                        },\n                        5\n                     );\n                     //  FEATURE: confirm if user want to be redirected\n                     frappe.confirm(\n                        __(\"Do you want to be redirected to the newly created iPay Request?\"),\n                        function () {\n                           // Action for \"Yes\"\n                           frappe.set_route(\"Form\", \"iPay Request\", r.message.name);\n                        },\n                        function () {\n                           // Action for \"No\"\n                           console.log(\"User chose not to be redirected.\");\n                        }\n                     );\n                  } else {\n                     frappe.msgprint(__(\"Failed to create iPay Request\"));\n                  }\n               },\n            });\n         })\n            .addClass(\"btn-warning\")\n            .removeClass(\"btn-default\");\n      }\n   },\n});\n\n// TODO: Make cration of ipay request automatic for COD Sales Invoices.\n"],
  "mappings": ";;AAAA,SAAO,GAAG,KAAK,GAAG,iBAAiB;AAAA,IAChC,QAAQ,KAAK;AACV,YAAM,YAAY,IAAI,IAAI,cAAc;AACxC,YAAM,SAAS,IAAI,IAAI;AACvB,YAAM,MAAM,IAAI,IAAI,qBAAqB;AAEzC,UAAI,aAAa,OAAO,WAAW,QAAQ;AACxC,YAAI,kBAAkB,GAAG,cAAc,GAAG,MAAM;AAG7C,gBAAM,WAAW,IAAI,IAAI;AACzB,gBAAM,eAAe,IAAI,IAAI;AAG7B,iBAAO,KAAK;AAAA,YACT,QAAQ;AAAA,YACR,MAAM;AAAA,cACH,KAAK;AAAA,gBACF,SAAS;AAAA,gBACT;AAAA,gBACA,eAAe;AAAA,gBACf,WAAW;AAAA,cACd;AAAA,YACH;AAAA,YACA,QAAQ;AAAA,YACR,OAAO;AAAA,YACP,UAAU,SAAU,GAAG;AACpB,kBAAI,CAAC,EAAE,KAAK;AAGT,uBAAO,WACJ;AAAA,kBACG,SAAS,GAAG,mCAAmC;AAAA,kBAC/C,WAAW;AAAA,gBACd,GACA,CACH;AAEA,uBAAO,QACJ,GAAG,iEAAiE,GACpE,WAAY;AAET,yBAAO,UAAU,QAAQ,gBAAgB,EAAE,QAAQ,IAAI;AAAA,gBAC1D,GACA,WAAY;AAET,0BAAQ,IAAI,kCAAkC;AAAA,gBACjD,CACH;AAAA,cACH,OAAO;AACJ,uBAAO,SAAS,GAAG,+BAA+B,CAAC;AAAA,cACtD;AAAA,YACH;AAAA,UACH,CAAC;AAAA,QACJ,CAAC,EACG,SAAS,aAAa,EACtB,YAAY,aAAa;AAAA,MAChC;AAAA,IACH;AAAA,EACH,CAAC;",
  "names": []
}
